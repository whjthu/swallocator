[2879840 ## mn146: 26567 ## 2021-08-23/03:17:16] cnodenum= 1, job-resource-list: 103560[mpemap:0x1][spemap:0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]
[2879840 ## mn146: 26567 ## 2021-08-23/03:17:16] control node is: mn146.
[2879840 ## mn146: 26567 ## 2021-08-23/03:17:16] sub control node number is 1, list: mn405.
vn103560: no optimizer found. set to paro
vn103560: using world size: 1, data-parallel-size: 1, tensor-model-parallel size: 1, pipeline-model-parallel size: 1 
vn103560: using torch.float32 for parameters ...
vn103560: WARNING: overriding default arguments for tokenizer_type:GPT2BPETokenizer                        with tokenizer_type:BertWordPieceLowerCase
vn103560: ------------------------ arguments ------------------------
vn103560:   adam_beta1 ...................................... 0.90000000000000002
vn103560:   adam_beta2 ...................................... 0.999
vn103560:   adam_eps ........................................ 1e-08
vn103560:   adlr_autoresume ................................. False
vn103560:   adlr_autoresume_interval ........................ 1000
vn103560:   apex_o1 ......................................... False
vn103560:   apply_query_key_layer_scaling ................... True
vn103560:   apply_residual_connection_post_layernorm ........ False
vn103560:   attention_dropout ............................... 0.10000000000000001
vn103560:   attention_softmax_in_fp32 ....................... False
vn103560:   balance_loss_weight ............................. 1
vn103560:   balance_strategy ................................ swipe
vn103560:   bert_load ....................................... None
vn103560:   bf16 ............................................ False
vn103560:   bias_dropout_fusion ............................. False
vn103560:   bias_gelu_fusion ................................ False
vn103560:   block_data_path ................................. None
vn103560:   checkpoint_activations .......................... False
vn103560:   checkpoint_num_layers ........................... 1
vn103560:   clip_grad ....................................... 1.0
vn103560:   concat_two ...................................... True
vn103560:   consumed_train_samples .......................... 0
vn103560:   consumed_valid_samples .......................... 0
vn103560:   crazy ........................................... False
vn103560:   crazy_dp ........................................ -1
vn103560:   data_impl ....................................... mmap
vn103560:   data_parallel_size .............................. 1
vn103560:   data_path ....................................... None
vn103560:   DDP_impl ........................................ local
vn103560:   distribute_checkpointed_activations ............. False
vn103560:   distributed_backend ............................. mpi
vn103560:   eod_mask_loss ................................... True
vn103560:   eval_interval ................................... 50
vn103560:   eval_iters ...................................... 10
vn103560:   exit_duration_in_mins ........................... None
vn103560:   exit_interval ................................... None
vn103560:   faiss_use_gpu ................................... False
vn103560:   finetune ........................................ False
vn103560:   fmoefy .......................................... False
vn103560:   fp16 ............................................ False
vn103560:   fp32_allreduce .................................. False
vn103560:   fp32_dynamic_loss_scale ......................... False
vn103560:   fp32_fast_linear ................................ False
vn103560:   fp32_layernorm .................................. False
vn103560:   fp32_residual_connection ........................ False
vn103560:   fp32_static_loss_scale .......................... 1.0
vn103560:   global_batch_size ............................... 12
vn103560:   half_lm_cross_entropy ........................... False
vn103560:   hidden_dropout .................................. 0.10000000000000001
vn103560:   hidden_hidden_size .............................. 6144
vn103560:   hidden_size ..................................... 3072
vn103560:   hysteresis ...................................... 2
vn103560:   ict_head_size ................................... None
vn103560:   ict_load ........................................ None
vn103560:   indexer_batch_size .............................. 128
vn103560:   indexer_log_interval ............................ 1000
vn103560:   init_method_std ................................. 0.01
vn103560:   initial_loss_scale .............................. 4294967296
vn103560:   layernorm_epsilon ............................... 1.0000000000000001e-05
vn103560:   lazy_mpu_init ................................... None
vn103560:   load ............................................ ./ckpt/m6-1233
vn103560:   local_rank ...................................... None
vn103560:   log_interval .................................... 1
vn103560:   loss_scale ...................................... None
vn103560:   loss_scale_window ............................... 1000
vn103560:   lr .............................................. 2.0000000000000002e-05
vn103560:   lr_decay_iters .................................. 1000
vn103560:   lr_decay_samples ................................ None
vn103560:   lr_decay_style .................................. linear
vn103560:   lr_warmup_fraction .............................. 0.02
vn103560:   lr_warmup_iters ................................. 0
vn103560:   lr_warmup_samples ............................... 0
vn103560:   lunatic ......................................... False
vn103560:   m6_img_feature_dim .............................. 2048
vn103560:   m6_img_file_list ................................ /home/export/online1/mdt00/shisuan/swpacai/dataset/train_100_img.flist
vn103560:   m6_patch_nums ................................... 16
vn103560:   m6_txt_file_list ................................ /home/export/online1/mdt00/shisuan/swpacai/dataset/train_100_txt.flist
vn103560:   make_vocab_size_divisible_by .................... 512
vn103560:   mask_prob ....................................... 0.14999999999999999
vn103560:   max_position_embeddings ......................... 128
vn103560:   merge_file ...................................... None
vn103560:   micro_batch_size ................................ 12
vn103560:   min_loss_scale .................................. 1.0
vn103560:   min_lr .......................................... 0.0
vn103560:   mmap_warmup ..................................... False
vn103560:   moe_size ........................................ 256
vn103560:   no_load_optim ................................... False
vn103560:   no_load_rng ..................................... False
vn103560:   no_mid_align .................................... False
vn103560:   no_save_optim ................................... False
vn103560:   no_save_rng ..................................... False
vn103560:   num_attention_heads ............................. 8
vn103560:   num_experts ..................................... 1
vn103560:   num_layers ...................................... 22
vn103560:   num_workers ..................................... 0
vn103560:   onnx_safe ....................................... None
vn103560:   openai_gelu ..................................... False
vn103560:   optimizer_type .................................. paro
vn103560:   override_lr_scheduler ........................... False
vn103560:   pad_mask_loss ................................... True
vn103560:   params_dtype .................................... torch.float32
vn103560:   pipeline_model_parallel_size .................... 1
vn103560:   print_ops ....................................... False
vn103560:   print_ops_freq .................................. -1
vn103560:   prompt_length ................................... 512
vn103560:   query_in_block_prob ............................. 0.10000000000000001
vn103560:   rampup_batch_size ............................... None
vn103560:   rank ............................................ 0
vn103560:   report_topk_accuracies .......................... []
vn103560:   reset_attention_mask ............................ False
vn103560:   reset_position_ids .............................. False
vn103560:   save ............................................ ./ckpt/m6-1233
vn103560:   save_interval ................................... 50
vn103560:   scaled_masked_softmax_fusion .................... False
vn103560:   scaled_upper_triang_masked_softmax_fusion ....... False
vn103560:   seed ............................................ 1234
vn103560:   seq_length ...................................... 128
vn103560:   share_gate ...................................... False
vn103560:   short_seq_prob .................................. 0.10000000000000001
vn103560:   sn_size ......................................... 256
vn103560:   split ........................................... 990,9,1
vn103560:   sw_align ........................................ 192
vn103560:   tensor_model_parallel_size ...................... 1
vn103560:   tensorboard_dir ................................. None
vn103560:   titles_data_path ................................ None
vn103560:   tokenizer_type .................................. BertWordPieceLowerCase
vn103560:   top_k ........................................... 2
vn103560:   train_iters ..................................... 1000
vn103560:   train_samples ................................... None
vn103560:   use_checkpoint_lr_scheduler ..................... False
vn103560:   use_cpu_initialization .......................... True
vn103560:   use_one_sent_docs ............................... False
vn103560:   vocab_file ...................................... ./dataset/vocab.txt
vn103560:   weight_decay .................................... 0.01
vn103560:   world_size ...................................... 1
vn103560:   zero_gate ....................................... False
vn103560: -------------------- end of arguments ---------------------
vn103560: setting number of micro-batches to constant 1
vn103560: > building BertWordPieceLowerCase tokenizer ...
vn103560:  > padded vocab (size: 21128) with 376 dummy tokens (new size: 21504)
vn103560: > initializing torch distributed ...
vn103560: > initializing tensor model parallel with size 1
vn103560: > initializing pipeline model parallel with size 1
vn103560: > Megatron distributed init time 0.029004335403442383 s
vn103560: > setting random seeds to 1234 ...
vn103560: time to initialize megatron (seconds): 3.460
vn103560: [after megatron is initialized] datetime: 2021-08-23 03:18:27 
vn103560: building GPT model ...
vn103560:  > number of parameters with row size 240: 2.565098e+09
vn103560: time (ms) | build model: 1036.45
vn103560: [ParO] Total params 2565098496, own params 2565098496
vn103560: > learning rate decay style: linear
vn103560: Loading checkpoint from ./ckpt/m6-1233
vn103560: WARNING: could not find the metadata file ./ckpt/m6-1233/latest_checkpointed_iteration.txt 
vn103560:     will not load any checkpoints and will start from random
vn103560: time (ms) | load checkpoint: 2.45
vn103560: > building train, validation, and test datasets ...
vn103560:  > datasets target sizes (minimum size):
vn103560:     train:      12000
vn103560:     validation: 2520
vn103560:     test:       120
vn103560: > building train, validation, and test datasets for GPT ...
vn103560:     train:
vn103560:       file list indices in [0, 3) total of 3 files
vn103560:     valid:
vn103560:       file list indices in [3, 3) total of 0 files
vn103560:     test:
vn103560:       file list indices in [3, 3) total of 0 files
vn103560: > finished creating GPT datasets ...
vn103560: [after dataloaders are built] datetime: 2021-08-23 03:18:29 
vn103560: [after model, optimizer, and learning rate scheduler are built] datetime: 2021-08-23 03:18:29 
vn103560: done with setups ...
vn103560: time (ms) | model and optimizer: 1302.25 | train/valid/test data iterators: 373.11
vn103560: training ...
vn103560: [before the start of training step] datetime: 2021-08-23 03:18:29 
vn103560: forwarding 0. Mem: 19.108 GB
vn103560: backwarding 0. Mem: 27.278 GB
vn103560: optimizing. Mem: 28.660640224814415 GB
vn103560:  iteration        1/    1000 | consumed samples:           12 | elapsed time per iteration (ms): 5732.2 | total FLOPS: 0.000000e+00 | learning rate: 1.000E-06 | global batch size:    12 | lm loss: 1.007479E+01 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 27.278 GB |
vn103560: memory report func mocked
vn103560: time (ms) | forward-compute: 1258.64 | backward-compute: 1729.36 | backward-embedding-all-reduce: 0.10 | optimizer: 2721.59 | paro-collect: 771.78 | optimizer-compute: 1672.59 | paro-dispatch: 276.97 | paro-row-rsm: 1.19 | paro-col-allred: 1.25 | paro-row-allg: 119.41 | batch-generator: 41.70
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration        2/    1000 | consumed samples:           24 | elapsed time per iteration (ms): 5596.8 | total FLOPS: 4.300386e+12 | learning rate: 2.000E-06 | global batch size:    12 | lm loss: 1.008745E+01 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1254.06 | backward-compute: 1709.69 | backward-embedding-all-reduce: 0.11 | optimizer: 2606.61 | paro-collect: 770.27 | optimizer-compute: 1559.28 | paro-dispatch: 276.89 | paro-row-rsm: 1.11 | paro-col-allred: 1.21 | paro-row-allg: 119.07 | batch-generator: 44.06
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration        3/    1000 | consumed samples:           36 | elapsed time per iteration (ms): 5598.9 | total FLOPS: 4.298765e+12 | learning rate: 3.000E-06 | global batch size:    12 | lm loss: 9.591714E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1256.55 | backward-compute: 1711.58 | backward-embedding-all-reduce: 0.11 | optimizer: 2605.06 | paro-collect: 770.45 | optimizer-compute: 1557.52 | paro-dispatch: 276.91 | paro-row-rsm: 1.14 | paro-col-allred: 1.19 | paro-row-allg: 119.33 | batch-generator: 38.16
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration        4/    1000 | consumed samples:           48 | elapsed time per iteration (ms): 5602.9 | total FLOPS: 4.295695e+12 | learning rate: 4.000E-06 | global batch size:    12 | lm loss: 9.554235E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1257.67 | backward-compute: 1712.90 | backward-embedding-all-reduce: 0.11 | optimizer: 2606.00 | paro-collect: 769.31 | optimizer-compute: 1559.66 | paro-dispatch: 276.85 | paro-row-rsm: 1.11 | paro-col-allred: 1.23 | paro-row-allg: 119.11 | batch-generator: 39.24
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration        5/    1000 | consumed samples:           60 | elapsed time per iteration (ms): 5601.4 | total FLOPS: 4.296859e+12 | learning rate: 5.000E-06 | global batch size:    12 | lm loss: 9.134364E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1255.58 | backward-compute: 1711.55 | backward-embedding-all-reduce: 0.11 | optimizer: 2608.12 | paro-collect: 770.77 | optimizer-compute: 1559.64 | paro-dispatch: 277.54 | paro-row-rsm: 1.12 | paro-col-allred: 1.21 | paro-row-allg: 119.49 | batch-generator: 37.20
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration        6/    1000 | consumed samples:           72 | elapsed time per iteration (ms): 5611.4 | total FLOPS: 4.289170e+12 | learning rate: 6.000E-06 | global batch size:    12 | lm loss: 9.080008E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1264.26 | backward-compute: 1711.87 | backward-embedding-all-reduce: 0.11 | optimizer: 2608.98 | paro-collect: 771.01 | optimizer-compute: 1560.49 | paro-dispatch: 277.31 | paro-row-rsm: 1.16 | paro-col-allred: 1.19 | paro-row-allg: 119.29 | batch-generator: 45.82
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration        7/    1000 | consumed samples:           84 | elapsed time per iteration (ms): 5607.6 | total FLOPS: 4.292118e+12 | learning rate: 7.000E-06 | global batch size:    12 | lm loss: 8.687927E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1263.43 | backward-compute: 1708.94 | backward-embedding-all-reduce: 0.11 | optimizer: 2609.17 | paro-collect: 770.27 | optimizer-compute: 1560.94 | paro-dispatch: 277.79 | paro-row-rsm: 1.14 | paro-col-allred: 1.20 | paro-row-allg: 119.70 | batch-generator: 45.03
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration        8/    1000 | consumed samples:           96 | elapsed time per iteration (ms): 5599.2 | total FLOPS: 4.298552e+12 | learning rate: 8.000E-06 | global batch size:    12 | lm loss: 8.745925E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1250.93 | backward-compute: 1712.27 | backward-embedding-all-reduce: 0.11 | optimizer: 2609.21 | paro-collect: 770.62 | optimizer-compute: 1561.37 | paro-dispatch: 277.04 | paro-row-rsm: 1.12 | paro-col-allred: 1.17 | paro-row-allg: 119.15 | batch-generator: 37.64
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration        9/    1000 | consumed samples:          108 | elapsed time per iteration (ms): 5604.6 | total FLOPS: 4.294376e+12 | learning rate: 9.000E-06 | global batch size:    12 | lm loss: 9.319661E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1257.75 | backward-compute: 1712.44 | backward-embedding-all-reduce: 0.11 | optimizer: 2608.75 | paro-collect: 771.76 | optimizer-compute: 1560.14 | paro-dispatch: 276.67 | paro-row-rsm: 1.10 | paro-col-allred: 1.19 | paro-row-allg: 119.15 | batch-generator: 39.38
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       10/    1000 | consumed samples:          120 | elapsed time per iteration (ms): 5597.1 | total FLOPS: 4.300106e+12 | learning rate: 1.000E-05 | global batch size:    12 | lm loss: 8.666235E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1255.57 | backward-compute: 1709.73 | backward-embedding-all-reduce: 0.11 | optimizer: 2605.60 | paro-collect: 770.58 | optimizer-compute: 1557.79 | paro-dispatch: 277.06 | paro-row-rsm: 1.12 | paro-col-allred: 1.18 | paro-row-allg: 119.04 | batch-generator: 44.45
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       11/    1000 | consumed samples:          132 | elapsed time per iteration (ms): 5596.9 | total FLOPS: 4.300312e+12 | learning rate: 1.100E-05 | global batch size:    12 | lm loss: 8.790377E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1253.80 | backward-compute: 1710.95 | backward-embedding-all-reduce: 0.11 | optimizer: 2606.12 | paro-collect: 770.39 | optimizer-compute: 1558.51 | paro-dispatch: 277.05 | paro-row-rsm: 1.13 | paro-col-allred: 1.19 | paro-row-allg: 119.04 | batch-generator: 38.13
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       12/    1000 | consumed samples:          144 | elapsed time per iteration (ms): 5598.3 | total FLOPS: 4.299236e+12 | learning rate: 1.200E-05 | global batch size:    12 | lm loss: 8.675269E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1255.00 | backward-compute: 1708.48 | backward-embedding-all-reduce: 0.11 | optimizer: 2608.09 | paro-collect: 770.31 | optimizer-compute: 1560.28 | paro-dispatch: 277.33 | paro-row-rsm: 1.13 | paro-col-allred: 1.19 | paro-row-allg: 119.48 | batch-generator: 41.29
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       13/    1000 | consumed samples:          156 | elapsed time per iteration (ms): 5604.2 | total FLOPS: 4.294676e+12 | learning rate: 1.300E-05 | global batch size:    12 | lm loss: 8.614211E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1262.07 | backward-compute: 1709.93 | backward-embedding-all-reduce: 0.11 | optimizer: 2606.37 | paro-collect: 770.35 | optimizer-compute: 1558.97 | paro-dispatch: 276.88 | paro-row-rsm: 1.11 | paro-col-allred: 1.18 | paro-row-allg: 119.14 | batch-generator: 43.62
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       14/    1000 | consumed samples:          168 | elapsed time per iteration (ms): 5604.4 | total FLOPS: 4.294540e+12 | learning rate: 1.400E-05 | global batch size:    12 | lm loss: 8.186417E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1258.01 | backward-compute: 1713.74 | backward-embedding-all-reduce: 0.11 | optimizer: 2605.74 | paro-collect: 769.52 | optimizer-compute: 1559.41 | paro-dispatch: 276.63 | paro-row-rsm: 1.13 | paro-col-allred: 1.25 | paro-row-allg: 119.12 | batch-generator: 39.66
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       15/    1000 | consumed samples:          180 | elapsed time per iteration (ms): 5598.9 | total FLOPS: 4.298749e+12 | learning rate: 1.500E-05 | global batch size:    12 | lm loss: 8.526912E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1249.66 | backward-compute: 1715.74 | backward-embedding-all-reduce: 0.11 | optimizer: 2608.01 | paro-collect: 771.25 | optimizer-compute: 1559.87 | paro-dispatch: 276.73 | paro-row-rsm: 1.20 | paro-col-allred: 1.22 | paro-row-allg: 119.34 | batch-generator: 36.25
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       16/    1000 | consumed samples:          192 | elapsed time per iteration (ms): 5601.8 | total FLOPS: 4.296524e+12 | learning rate: 1.600E-05 | global batch size:    12 | lm loss: 8.451771E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1255.57 | backward-compute: 1712.63 | backward-embedding-all-reduce: 0.11 | optimizer: 2606.40 | paro-collect: 769.35 | optimizer-compute: 1559.87 | paro-dispatch: 277.00 | paro-row-rsm: 1.12 | paro-col-allred: 1.19 | paro-row-allg: 119.47 | batch-generator: 37.20
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       17/    1000 | consumed samples:          204 | elapsed time per iteration (ms): 5600.6 | total FLOPS: 4.297442e+12 | learning rate: 1.700E-05 | global batch size:    12 | lm loss: 8.347620E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1254.75 | backward-compute: 1710.49 | backward-embedding-all-reduce: 0.11 | optimizer: 2609.02 | paro-collect: 771.41 | optimizer-compute: 1560.79 | paro-dispatch: 276.63 | paro-row-rsm: 1.13 | paro-col-allred: 1.20 | paro-row-allg: 119.27 | batch-generator: 36.34
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       18/    1000 | consumed samples:          216 | elapsed time per iteration (ms): 5608.7 | total FLOPS: 4.291230e+12 | learning rate: 1.800E-05 | global batch size:    12 | lm loss: 8.378774E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1260.11 | backward-compute: 1712.67 | backward-embedding-all-reduce: 0.11 | optimizer: 2609.88 | paro-collect: 772.92 | optimizer-compute: 1560.08 | paro-dispatch: 276.64 | paro-row-rsm: 1.13 | paro-col-allred: 1.21 | paro-row-allg: 119.21 | batch-generator: 45.59
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       19/    1000 | consumed samples:          228 | elapsed time per iteration (ms): 5601.8 | total FLOPS: 4.296497e+12 | learning rate: 1.900E-05 | global batch size:    12 | lm loss: 8.212354E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1255.85 | backward-compute: 1712.94 | backward-embedding-all-reduce: 0.11 | optimizer: 2606.71 | paro-collect: 769.88 | optimizer-compute: 1559.86 | paro-dispatch: 276.78 | paro-row-rsm: 1.13 | paro-col-allred: 1.19 | paro-row-allg: 119.18 | batch-generator: 37.45
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       20/    1000 | consumed samples:          240 | elapsed time per iteration (ms): 5608.1 | total FLOPS: 4.291706e+12 | learning rate: 2.000E-05 | global batch size:    12 | lm loss: 8.083862E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1259.02 | backward-compute: 1712.68 | backward-embedding-all-reduce: 0.11 | optimizer: 2609.70 | paro-collect: 770.89 | optimizer-compute: 1561.97 | paro-dispatch: 276.66 | paro-row-rsm: 1.14 | paro-col-allred: 1.18 | paro-row-allg: 119.12 | batch-generator: 45.71
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560:  iteration       21/    1000 | consumed samples:          252 | elapsed time per iteration (ms): 5600.0 | total FLOPS: 4.297939e+12 | learning rate: 1.998E-05 | global batch size:    12 | lm loss: 8.024045E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1252.79 | backward-compute: 1711.99 | backward-embedding-all-reduce: 0.11 | optimizer: 2609.33 | paro-collect: 771.32 | optimizer-compute: 1560.56 | paro-dispatch: 277.27 | paro-row-rsm: 1.11 | paro-col-allred: 1.19 | paro-row-allg: 119.65 | batch-generator: 38.33
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       22/    1000 | consumed samples:          264 | elapsed time per iteration (ms): 3647.0 | total FLOPS: 6.565157e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1256.74 | backward-compute: 1710.19 | backward-embedding-all-reduce: 0.11 | optimizer: 653.22 | paro-collect: 652.88 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.13 | paro-col-allred: 1.20 | paro-row-allg: 0.00 | batch-generator: 38.39
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       23/    1000 | consumed samples:          276 | elapsed time per iteration (ms): 3646.5 | total FLOPS: 6.566089e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1256.26 | backward-compute: 1711.48 | backward-embedding-all-reduce: 0.11 | optimizer: 652.69 | paro-collect: 652.36 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.20 | paro-col-allred: 1.27 | paro-row-allg: 0.00 | batch-generator: 41.93
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       24/    1000 | consumed samples:          288 | elapsed time per iteration (ms): 3662.0 | total FLOPS: 6.538244e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1263.86 | backward-compute: 1718.30 | backward-embedding-all-reduce: 0.11 | optimizer: 653.14 | paro-collect: 652.71 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.20 | paro-col-allred: 1.20 | paro-row-allg: 0.00 | batch-generator: 45.56
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       25/    1000 | consumed samples:          300 | elapsed time per iteration (ms): 3654.9 | total FLOPS: 6.551012e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1257.98 | backward-compute: 1715.04 | backward-embedding-all-reduce: 0.11 | optimizer: 655.66 | paro-collect: 655.32 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.16 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 44.13
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       26/    1000 | consumed samples:          312 | elapsed time per iteration (ms): 3650.4 | total FLOPS: 6.559078e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1257.43 | backward-compute: 1711.53 | backward-embedding-all-reduce: 0.16 | optimizer: 654.79 | paro-collect: 654.46 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.17 | paro-col-allred: 1.20 | paro-row-allg: 0.00 | batch-generator: 39.13
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       27/    1000 | consumed samples:          324 | elapsed time per iteration (ms): 3648.1 | total FLOPS: 6.563226e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1257.70 | backward-compute: 1711.19 | backward-embedding-all-reduce: 0.11 | optimizer: 653.66 | paro-collect: 653.33 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.17 | paro-col-allred: 1.27 | paro-row-allg: 0.00 | batch-generator: 39.35
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       28/    1000 | consumed samples:          336 | elapsed time per iteration (ms): 3643.4 | total FLOPS: 6.571655e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1254.31 | backward-compute: 1710.18 | backward-embedding-all-reduce: 0.11 | optimizer: 652.18 | paro-collect: 651.85 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.19 | paro-col-allred: 1.19 | paro-row-allg: 0.00 | batch-generator: 41.12
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       29/    1000 | consumed samples:          348 | elapsed time per iteration (ms): 3647.5 | total FLOPS: 6.564337e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1253.60 | backward-compute: 1713.76 | backward-embedding-all-reduce: 0.11 | optimizer: 654.27 | paro-collect: 653.95 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.15 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 38.48
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       30/    1000 | consumed samples:          360 | elapsed time per iteration (ms): 3649.9 | total FLOPS: 6.559925e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1259.24 | backward-compute: 1709.02 | backward-embedding-all-reduce: 0.11 | optimizer: 654.77 | paro-collect: 654.43 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.28 | paro-col-allred: 1.20 | paro-row-allg: 0.00 | batch-generator: 40.90
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       31/    1000 | consumed samples:          372 | elapsed time per iteration (ms): 3663.6 | total FLOPS: 6.535478e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1269.87 | backward-compute: 1712.26 | backward-embedding-all-reduce: 0.11 | optimizer: 655.37 | paro-collect: 655.04 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.17 | paro-col-allred: 1.24 | paro-row-allg: 0.00 | batch-generator: 41.60
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       32/    1000 | consumed samples:          384 | elapsed time per iteration (ms): 3650.5 | total FLOPS: 6.558958e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1256.41 | backward-compute: 1713.25 | backward-embedding-all-reduce: 0.11 | optimizer: 654.26 | paro-collect: 653.93 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.17 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 38.09
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       33/    1000 | consumed samples:          396 | elapsed time per iteration (ms): 3646.4 | total FLOPS: 6.566339e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1251.52 | backward-compute: 1714.26 | backward-embedding-all-reduce: 0.11 | optimizer: 654.74 | paro-collect: 654.41 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.15 | paro-col-allred: 1.24 | paro-row-allg: 0.00 | batch-generator: 38.35
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       34/    1000 | consumed samples:          408 | elapsed time per iteration (ms): 3651.2 | total FLOPS: 6.557622e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1260.12 | backward-compute: 1709.70 | backward-embedding-all-reduce: 0.11 | optimizer: 654.59 | paro-collect: 654.26 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.15 | paro-col-allred: 1.20 | paro-row-allg: 0.00 | batch-generator: 41.80
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       35/    1000 | consumed samples:          420 | elapsed time per iteration (ms): 3651.8 | total FLOPS: 6.556588e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1259.50 | backward-compute: 1711.46 | backward-embedding-all-reduce: 0.11 | optimizer: 654.85 | paro-collect: 654.48 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.17 | paro-col-allred: 1.22 | paro-row-allg: 0.00 | batch-generator: 41.17
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       36/    1000 | consumed samples:          432 | elapsed time per iteration (ms): 3652.3 | total FLOPS: 6.555709e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1257.77 | backward-compute: 1714.07 | backward-embedding-all-reduce: 0.11 | optimizer: 654.18 | paro-collect: 653.85 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.15 | paro-col-allred: 1.22 | paro-row-allg: 0.00 | batch-generator: 39.50
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       37/    1000 | consumed samples:          444 | elapsed time per iteration (ms): 3652.9 | total FLOPS: 6.554620e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1259.13 | backward-compute: 1714.30 | backward-embedding-all-reduce: 0.11 | optimizer: 653.42 | paro-collect: 653.09 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.17 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 37.85
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       38/    1000 | consumed samples:          456 | elapsed time per iteration (ms): 3656.2 | total FLOPS: 6.548669e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1263.26 | backward-compute: 1712.17 | backward-embedding-all-reduce: 0.11 | optimizer: 654.30 | paro-collect: 653.97 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.24 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 44.96
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       39/    1000 | consumed samples:          468 | elapsed time per iteration (ms): 3648.9 | total FLOPS: 6.561713e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1257.80 | backward-compute: 1710.05 | backward-embedding-all-reduce: 0.11 | optimizer: 655.23 | paro-collect: 654.90 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.16 | paro-col-allred: 1.20 | paro-row-allg: 0.00 | batch-generator: 39.48
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       40/    1000 | consumed samples:          480 | elapsed time per iteration (ms): 3654.5 | total FLOPS: 6.551694e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1258.82 | backward-compute: 1715.58 | backward-embedding-all-reduce: 0.11 | optimizer: 653.44 | paro-collect: 653.11 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.18 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 40.51
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       41/    1000 | consumed samples:          492 | elapsed time per iteration (ms): 3648.9 | total FLOPS: 6.561831e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1258.03 | backward-compute: 1710.94 | backward-embedding-all-reduce: 0.11 | optimizer: 653.94 | paro-collect: 653.61 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.24 | paro-col-allred: 1.23 | paro-row-allg: 0.00 | batch-generator: 36.71
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       42/    1000 | consumed samples:          504 | elapsed time per iteration (ms): 3646.6 | total FLOPS: 6.565968e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1252.85 | backward-compute: 1713.38 | backward-embedding-all-reduce: 0.11 | optimizer: 653.93 | paro-collect: 653.60 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.36 | paro-col-allred: 1.23 | paro-row-allg: 0.00 | batch-generator: 37.67
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       43/    1000 | consumed samples:          516 | elapsed time per iteration (ms): 3650.3 | total FLOPS: 6.559364e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1260.09 | backward-compute: 1709.15 | backward-embedding-all-reduce: 0.11 | optimizer: 655.13 | paro-collect: 654.80 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.22 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 41.79
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       44/    1000 | consumed samples:          528 | elapsed time per iteration (ms): 3655.5 | total FLOPS: 6.549860e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1259.68 | backward-compute: 1716.04 | backward-embedding-all-reduce: 0.11 | optimizer: 653.03 | paro-collect: 652.70 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.29 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 41.38
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       45/    1000 | consumed samples:          540 | elapsed time per iteration (ms): 3646.8 | total FLOPS: 6.565533e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1255.04 | backward-compute: 1712.06 | backward-embedding-all-reduce: 0.11 | optimizer: 653.40 | paro-collect: 653.06 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.26 | paro-col-allred: 1.20 | paro-row-allg: 0.00 | batch-generator: 36.76
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       46/    1000 | consumed samples:          552 | elapsed time per iteration (ms): 3646.4 | total FLOPS: 6.566363e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1255.47 | backward-compute: 1709.77 | backward-embedding-all-reduce: 0.11 | optimizer: 654.55 | paro-collect: 654.22 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.22 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 39.73
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       47/    1000 | consumed samples:          564 | elapsed time per iteration (ms): 3652.5 | total FLOPS: 6.555335e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1259.41 | backward-compute: 1711.85 | backward-embedding-all-reduce: 0.11 | optimizer: 654.59 | paro-collect: 654.25 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.30 | paro-col-allred: 1.22 | paro-row-allg: 0.00 | batch-generator: 43.90
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       48/    1000 | consumed samples:          576 | elapsed time per iteration (ms): 3654.8 | total FLOPS: 6.551258e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1259.81 | backward-compute: 1713.72 | backward-embedding-all-reduce: 0.11 | optimizer: 654.33 | paro-collect: 654.00 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.20 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 41.50
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       49/    1000 | consumed samples:          588 | elapsed time per iteration (ms): 3646.8 | total FLOPS: 6.565612e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1253.96 | backward-compute: 1711.77 | backward-embedding-all-reduce: 0.11 | optimizer: 654.56 | paro-collect: 654.23 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.17 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 37.46
vn103560: forwarding 0. Mem: 47.770 GB
vn103560: backwarding 0. Mem: 55.939 GB
vn103560: optimizing. Mem: 57.322268947958946 GB
vn103560: [INFO] backward overflow.
vn103560:  iteration       50/    1000 | consumed samples:          600 | elapsed time per iteration (ms): 3645.8 | total FLOPS: 6.567305e+12 | learning rate: 1.998E-05 | global batch size:    12 | loss scale: 1.0 | number of skipped iterations:   1 | number of nan iterations:   1 | allocated memory cur/max: 57.322 55.939 GB |
vn103560: time (ms) | forward-compute: 1256.12 | backward-compute: 1709.90 | backward-embedding-all-reduce: 0.11 | optimizer: 652.74 | paro-collect: 652.41 | optimizer-compute: 0.00 | paro-dispatch: 0.00 | paro-row-rsm: 1.19 | paro-col-allred: 1.21 | paro-row-allg: 0.00 | batch-generator: 40.46
vn103560: CPE array exception: array=0, on cpu vn103560.
vn103560: SLB exception: [scoreid: 6], [type: non-cacheable read], [request: DMA/RDMA], [dstaddr[0:44]=0x1a39c1ae4300]
vn103560:  
[2879840 ## 2021-08-23/03:28:00] receive request of kill job(bkill).
[2879840 ## mn146: 26567 ## 2021-08-23/03:28:32] job_finished. use-time: 675.893833 (secs)
